<!doctype html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MMD Motion Editor</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">
</head>

<body>
  <!-- App Shell -->
  <div id="app">
    <!-- Top Toolbar -->
    <header id="toolbar">
      <div class="toolbar-left">
        <div class="app-logo">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="url(#grad1)" />
            <path d="M2 17L12 22L22 17" stroke="url(#grad2)" stroke-width="2" fill="none" />
            <path d="M2 12L12 17L22 12" stroke="url(#grad2)" stroke-width="2" fill="none" />
            <defs>
              <linearGradient id="grad1" x1="2" y1="2" x2="22" y2="12">
                <stop offset="0%" stop-color="#6366f1" />
                <stop offset="100%" stop-color="#ec4899" />
              </linearGradient>
              <linearGradient id="grad2" x1="2" y1="12" x2="22" y2="22">
                <stop offset="0%" stop-color="#6366f1" />
                <stop offset="100%" stop-color="#ec4899" />
              </linearGradient>
            </defs>
          </svg>
          <span class="app-title">MMD Motion Editor</span>
        </div>
        <div class="toolbar-divider"></div>
        <button id="btn-load-file" class="toolbar-btn" title="PMX / VMD / VPD / 音源を読み込む">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 2h6l2 2h4v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V2zm3 7h6l-3 3-3-3zm2.5-4h1v3h-1V5z" />
          </svg>
          <span>ファイル読込</span>
        </button>
        <button id="btn-save-project" class="toolbar-btn" title="プロジェクトJSONを保存する">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 2h9l3 3v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V2zm2 1v3h6V3H4zm0 6v4h8V9H4z" />
          </svg>
          <span>プロジェクト保存</span>
        </button>
        <button id="btn-load-project" class="toolbar-btn" title="プロジェクトJSONを読み込む">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 2h6l2 2h4v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V2zm3 7h6l-3 3-3-3zm2.5-4h1v3h-1V5z" />
          </svg>
          <span>プロジェクト読込</span>
        </button>
        <button id="btn-toggle-ground" class="toolbar-btn toggle-on" title="地面表示を切り替える" aria-pressed="true">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M1 4h14v8H1z" />
            <path d="M1 8h14M8 4v8" stroke="currentColor" stroke-width="1" fill="none" />
          </svg>
          <span id="ground-toggle-text">床表示ON</span>
        </button>
        <button id="btn-toggle-skydome" class="toolbar-btn toggle-on" title="スカイドーム表示を切り替える" aria-pressed="true">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 10a6 6 0 1 1 12 0v4H2v-4z" />
            <path d="M2 10h12" stroke="currentColor" stroke-width="1" fill="none" />
          </svg>
          <span id="skydome-toggle-text">空表示ON</span>
        </button>
        <button id="btn-toggle-aa" class="toolbar-btn toggle-on" title="アンチエイリアスの有効/無効を切り替える" aria-pressed="true">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M2 12l3-8h2l3 8h-2l-.6-1.8H4.6L4 12H2zm3.1-3.3h1.8L6 6z" />
            <path d="M11 5h3v1h-3zM11 8h3v1h-3zM11 11h3v1h-3z" />
          </svg>
          <span id="aa-toggle-text">AA ON</span>
        </button>
        <button id="btn-toggle-physics" class="toolbar-btn toggle-on" title="物理演算の有効/無効を切り替える" aria-pressed="true">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M8 1.5a3 3 0 0 1 3 3v1h1.5a2 2 0 0 1 0 4H11v1a3 3 0 0 1-6 0v-1H3.5a2 2 0 0 1 0-4H5v-1a3 3 0 0 1 3-3z" />
          </svg>
          <span id="physics-toggle-text">物理ON</span>
        </button>
        <button id="btn-toggle-shader-panel" class="toolbar-btn toggle-on" title="エフェクトパネルの表示/非表示" aria-pressed="true">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.2">
            <rect x="2.2" y="3" width="11.6" height="10" rx="1.2" />
            <path d="M6 5.2v5.6M8.5 5.2v5.6M11 5.2v5.6" />
          </svg>
          <span id="shader-panel-toggle-text">Effect ON</span>
        </button>
        <button id="btn-toggle-fullscreen-ui" class="toolbar-btn" title="UIを非表示/表示 (ESCで戻る)" aria-pressed="false">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.4">
            <path d="M2 6V2h4M10 2h4v4M14 10v4h-4M6 14H2v-4" />
          </svg>
          <span id="fullscreen-ui-toggle-text">UI非表示OFF</span>
        </button>
      </div>
      <div class="toolbar-right">
        <div id="perf-display" class="perf-badge">
          <span id="fps-value">--</span>
          <span class="perf-label">FPS</span>
          <span class="perf-sep">|</span>
          <span id="engine-type-badge" class="engine-badge">WebGL2</span>
        </div>
        <div id="status-indicator" class="status-badge">
          <span class="status-dot"></span>
          <span id="status-text">待機中</span>
        </div>
      </div>
    </header>

    <!-- Main Content Area -->
    <div id="main-content">
      <!-- Left Panel: Playback + Timeline -->
      <aside id="timeline-panel">
        <section id="playback-section" class="left-panel-section">
          <div class="section-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
              <path d="M4 2l8 5-8 5V2z" />
            </svg>
            <span>再生</span>
          </div>
          <div id="playback-controls" class="playback-controls">
            <div class="playback-compact-row">
              <div class="transport-buttons">
                <button id="btn-skip-start" class="transport-btn" title="先頭へ">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M4 2h2v12H4V2zm2 6l7 5V3L6 8z" />
                  </svg>
                </button>
                <button id="btn-play" class="transport-btn play-btn" title="再生">
                  <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M5 3l12 7-12 7V3z" />
                  </svg>
                </button>
                <button id="btn-pause" class="transport-btn" title="一時停止" style="display:none;">
                  <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <rect x="4" y="3" width="4" height="14" />
                    <rect x="12" y="3" width="4" height="14" />
                  </svg>
                </button>
                <button id="btn-stop" class="transport-btn" title="停止">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <rect x="3" y="3" width="10" height="10" />
                  </svg>
                </button>
                <button id="btn-skip-end" class="transport-btn" title="末尾へ">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M10 2h2v12h-2V2zm-2 6L1 13V3l7 5z" />
                  </svg>
                </button>
              </div>
              <div class="playback-step-buttons">
                <button id="btn-kf-nudge-left" class="transport-btn playback-step-btn" type="button" title="1フレーム前へ">
                  <span aria-hidden="true">&larr;</span>
                </button>
                <button id="btn-kf-nudge-right" class="transport-btn playback-step-btn" type="button" title="1フレーム後へ">
                  <span aria-hidden="true">&rarr;</span>
                </button>
              </div>
              <div class="frame-display">
                <span class="frame-label">Frame</span>
                <span id="current-frame" class="frame-number">0</span>
                <span class="frame-separator">/</span>
                <span id="total-frames" class="frame-number">0</span>
              </div>
              <div class="volume-control">
                <button id="btn-mute" class="volume-mute-btn" title="ミュート切替">
                  <svg id="icon-volume-on" width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                    <path d="M2 5h3l4-3v10l-4-3H2V5zm8 .5a3 3 0 0 1 0 3" stroke="currentColor" stroke-width="1.2"
                      fill="none" />
                    <path d="M11.5 3.5a5 5 0 0 1 0 7" stroke="currentColor" stroke-width="1.2" fill="none" />
                  </svg>
                  <svg id="icon-volume-off" width="14" height="14" viewBox="0 0 14 14" fill="currentColor"
                    style="display:none">
                    <path d="M2 5h3l4-3v10l-4-3H2V5z" />
                    <path d="M10 5l3 4m0-4l-3 4" stroke="currentColor" stroke-width="1.2" fill="none" />
                  </svg>
                </button>
                <input type="range" id="volume-slider" class="volume-slider" min="0" max="100" value="100" step="1">
                <span id="volume-value" class="volume-value">100%</span>
              </div>
            </div>
          </div>
        </section>

        <section id="timeline-section" class="left-panel-section left-panel-section--timeline">
          <div class="panel-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
              <path d="M1 1h12v2H1V1zm0 4h12v2H1V5zm0 4h12v2H1V9z" />
            </svg>
            <span>タイムライン</span>
          </div>
          <div id="timeline-edit-toolbar">
            <div class="timeline-edit-buttons">
              <button id="btn-kf-add" class="timeline-edit-btn" type="button" title="現在フレームにキーフレームを登録">登録</button>
              <button id="btn-kf-delete" class="timeline-edit-btn" type="button" title="選択キーフレームを削除">削除</button>
            </div>
            <span id="timeline-selection-label" class="timeline-selection-label">トラック未選択</span>
          </div>
          <div id="timeline-container">
            <!-- Fixed left: frame labels -->
            <div id="timeline-labels">
              <canvas id="timeline-label-canvas"></canvas>
            </div>
            <!-- Scrollable right: track area with ruler overlay -->
            <div id="timeline-tracks-wrapper">
              <canvas id="timeline-overlay-canvas"></canvas>
              <div id="timeline-tracks-scroll">
                <canvas id="timeline-canvas"></canvas>
              </div>
            </div>
          </div>
        </section>

      </aside>
      <div id="timeline-resizer" role="separator" aria-orientation="vertical" aria-label="Timeline width resize"></div>

      <!-- Center: 3D Viewport -->
      <main id="viewport-container">
        <canvas id="render-canvas"></canvas>
        <div id="viewport-overlay" class="viewport-overlay">
          <div class="viewport-empty-state">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none" opacity="0.3">
              <path d="M32 4L4 20V44L32 60L60 44V20L32 4Z" stroke="currentColor" stroke-width="2" />
              <path d="M32 60V36" stroke="currentColor" stroke-width="2" />
              <path d="M4 20L32 36L60 20" stroke="currentColor" stroke-width="2" />
            </svg>
            <p>PMXモデルを読み込んでください</p>
            <span class="hint-text">ツールバーの「ファイル読込」ボタンか、Ctrl+Oで開く</span>
          </div>
        </div>
      </main>

      <!-- Right Panel: Effect -->
      <aside id="shader-panel">
        <div class="panel-header">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.2">
            <rect x="1.7" y="2" width="10.6" height="10" rx="1.2" />
            <path d="M4.6 4.2v5.6M7 4.2v5.6M9.4 4.2v5.6" />
          </svg>
          <span>エフェクト</span>
        </div>
        <div class="shader-panel-body">
          <div class="shader-panel-row">
            <span class="info-label">対象</span>
            <span id="shader-model-name" class="shader-model-name">-</span>
          </div>
          <div class="shader-panel-row">
            <span class="info-label">種類</span>
            <select id="shader-preset-select" class="panel-select" disabled>
              <option value="">-</option>
            </select>
          </div>
          <div class="shader-panel-actions">
            <button id="btn-shader-apply" class="info-action-btn" type="button" disabled>全材質へ割り当て</button>
            <button id="btn-shader-reset" class="info-action-btn" type="button" disabled>全材質を標準化</button>
          </div>
          <div id="shader-panel-note" class="shader-panel-note">モデルを読み込んでください</div>
          <div id="shader-material-list" class="shader-material-list">
            <div class="panel-empty-state">No model</div>
          </div>
        </div>
      </aside>

    </div>

    <!-- Bottom Panel: Morph + Camera + Controls -->
    <footer id="bottom-panel">
      <div class="bottom-panel-inner">

        <!-- 1: Info -->
        <section id="info-section" class="bottom-section">
          <div class="section-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
              <circle cx="7" cy="7" r="6" fill="none" stroke="currentColor" stroke-width="1.5" />
              <path d="M7 4v1M7 6.5v4" />
            </svg>
            <span>情報</span>
          </div>
          <div id="model-info" class="model-info">
            <div class="info-compact-top">
              <div class="info-target-row">
                <span class="info-label">対象</span>
                <select id="info-model-select" class="info-model-select" disabled>
                  <option value="">-</option>
                </select>
              </div>
              <div class="info-actions">
                <button id="btn-model-visibility" class="info-action-btn" type="button" disabled>非表示</button>
                <button id="btn-model-delete" class="info-action-btn info-action-btn--danger" type="button" disabled>削除</button>
              </div>
            </div>
            <div class="info-compact-stats">
              <span class="info-compact-item"><span class="info-compact-key">モデル</span><span id="info-model-name"
                  class="info-value">-</span></span>
              <span class="info-compact-item"><span class="info-compact-key">V</span><span id="info-vertices"
                  class="info-value">-</span></span>
              <span class="info-compact-item"><span class="info-compact-key">B</span><span id="info-bones"
                  class="info-value">-</span></span>
              <span class="info-compact-item"><span class="info-compact-key">M</span><span id="info-morphs"
                  class="info-value">-</span></span>
            </div>
          </div>
        </section>

        <!-- 2: Interpolation -->
        <section id="interpolation-section" class="bottom-section">
          <div class="section-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.2">
              <path d="M1.5 11.5C4 2.5 10 2.5 12.5 11.5" />
              <circle cx="2.5" cy="10.5" r="1.1" fill="currentColor" stroke="none" />
              <circle cx="11.5" cy="10.5" r="1.1" fill="currentColor" stroke="none" />
            </svg>
            <span>補間</span>
          </div>
          <div class="model-info interpolation-info">
            <div class="info-row interpolation-row--hidden"><span class="info-label">対象</span><span id="interp-track-name" class="info-value">-</span></div>
            <div class="info-row interpolation-row--hidden"><span class="info-label">フレーム</span><span id="interp-frame" class="info-value">-</span></div>
            <div class="interpolation-meta">
              <div class="info-row">
                <span class="info-label">種別</span>
                <select id="interp-type" class="interp-type-select" disabled>
                  <option value="__all__">全て</option>
                </select>
              </div>
              <div class="info-row interpolation-row--hidden"><span class="info-label">状態</span><span id="interp-status" class="info-value">準備中</span></div>
            </div>
            <div id="interp-curve-list" class="interp-curve-list">
              <div class="interp-curve-empty">トラックを選択すると表示されます</div>
            </div>
          </div>
        </section>

        <!-- 3: Bone Controls -->
        <section id="bone-section" class="bottom-section">
          <div class="section-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
              <path d="M3 4.5a1.5 1.5 0 1 1 3 0v1.2h2V4.5a1.5 1.5 0 1 1 3 0V9a1.5 1.5 0 1 1-3 0V7.9H6V9a1.5 1.5 0 1 1-3 0V4.5z" />
            </svg>
            <span>ボーン</span>
          </div>
          <div class="panel-select-row">
            <span class="panel-select-label">対象</span>
            <select id="bone-select" class="panel-select" disabled>
              <option value="">-</option>
            </select>
          </div>
          <div id="bone-controls" class="bone-controls">
            <div class="panel-empty-state">モデル未読込</div>
          </div>
        </section>

        <!-- 4: Morph Controls -->
        <section id="morph-section" class="bottom-section">
          <div class="section-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
              <circle cx="7" cy="5" r="3" />
              <path d="M2 12c0-2.5 2.2-4 5-4s5 1.5 5 4" />
            </svg>
            <span>モーフ</span>
          </div>
          <div class="panel-select-row">
            <span class="panel-select-label">表示枠</span>
            <select id="morph-frame-select" class="panel-select" disabled>
              <option value="">-</option>
            </select>
          </div>
          <div id="morph-controls" class="morph-controls">
            <div class="panel-empty-state">モデル未読込</div>
          </div>
        </section>

        <!-- 5: Camera Controls -->
        <section id="camera-section" class="bottom-section">
          <div class="section-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
              <path d="M2 3h7v8H2V3zm8 1l3-2v10l-3-2V4z" />
            </svg>
            <span>カメラ</span>
          </div>
          <div id="camera-controls" class="camera-controls">
            <div class="camera-view-buttons" role="group" aria-label="カメラ視点">
              <button id="btn-cam-left" class="camera-view-btn" type="button" aria-pressed="false">左面</button>
              <button id="btn-cam-front" class="camera-view-btn camera-view-btn--active" type="button" aria-pressed="true">正面</button>
              <button id="btn-cam-right" class="camera-view-btn" type="button" aria-pressed="false">右面</button>
            </div>
            <div class="control-row cam-slider-row cam-fov-row">
              <label class="cam-axis-label">FOV</label>
              <input type="range" id="cam-fov" class="cam-slider" min="10" max="120" value="30">
              <span id="cam-fov-value" class="value-display">30°</span>
            </div>
            <div class="control-row cam-slider-row dof-row-hidden">
              <label class="cam-axis-label">距離</label>
              <input type="range" id="cam-distance" class="cam-slider" min="5" max="400" value="45" step="1">
              <span id="cam-distance-value" class="value-display">45.0m</span>
            </div>
            <div id="camera-dof-controls" class="camera-dof-controls">
              <div class="effect-row effect-row-check">
                <span class="effect-label">DoF</span>
                <label class="effect-check-wrap">
                  <input type="checkbox" id="effect-dof-enabled" class="effect-check">
                  <span>有効</span>
                </label>
                <span id="effect-dof-enabled-val" class="effect-value">OFF</span>
              </div>
              <div class="effect-row dof-row-hidden">
                <span class="effect-label">DoF品質</span>
                <select id="effect-dof-quality" class="effect-select">
                  <option value="0">Low</option>
                  <option value="1" selected>Medium</option>
                  <option value="2">High</option>
                </select>
                <span id="effect-dof-quality-val" class="effect-value">Medium</span>
              </div>
              <div class="effect-row dof-row-hidden">
                <span class="effect-label">DoFフォーカス</span>
                <input type="range" id="effect-dof-focus" class="effect-slider" min="100" max="300000" value="55000" step="100">
                <span id="effect-dof-focus-val" class="effect-value">55.0m</span>
              </div>
              <div class="effect-row">
                <span class="effect-label">前方補正</span>
                <input type="range" id="effect-dof-focus-offset" class="effect-slider" min="0" max="20000" value="0" step="100">
                <span id="effect-dof-focus-offset-val" class="effect-value">0.0m</span>
              </div>
              <div class="effect-row dof-row-hidden">
                <span class="effect-label">DoF F-stop</span>
                <input type="range" id="effect-dof-fstop" class="effect-slider" min="0" max="400" value="280" step="1">
                <span id="effect-dof-fstop-val" class="effect-value">2.80</span>
              </div>
              <div class="effect-row dof-row-hidden">
                <span class="effect-label">前抑制</span>
                <input type="range" id="effect-dof-near-suppression" class="effect-slider" min="0" max="1000" value="400" step="1">
                <span id="effect-dof-near-suppression-val" class="effect-value">400%</span>
              </div>
              <div class="effect-row effect-row-check dof-row-hidden">
                <span class="effect-label">焦点距離反転</span>
                <label class="effect-check-wrap">
                  <input type="checkbox" id="effect-dof-focal-invert" class="effect-check">
                  <span>有効</span>
                </label>
                <span id="effect-dof-focal-invert-val" class="effect-value">OFF</span>
              </div>
              <div class="effect-row">
                <span class="effect-label">DoFレンズ</span>
                <input type="range" id="effect-dof-lens-size" class="effect-slider" min="1" max="4096" value="30" step="1">
                <span id="effect-dof-lens-size-val" class="effect-value">30</span>
              </div>
              <div class="effect-row dof-row-hidden">
                <span class="effect-label">DoF焦点距離</span>
                <input type="range" id="effect-dof-focal-length" class="effect-slider" min="1" max="300" value="50" step="1">
                <span id="effect-dof-focal-length-val" class="effect-value">50</span>
              </div>
            </div>
          </div>
        </section>

        <!-- 5: Lighting Controls -->
        <section id="lighting-section" class="bottom-section">
          <div class="section-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
              <circle cx="7" cy="7" r="2.5" />
              <path
                d="M7 1v2M7 11v2M1 7h2M11 7h2M3.22 3.22l1.41 1.41M9.37 9.37l1.41 1.41M3.22 10.78l1.41-1.41M9.37 4.63l1.41-1.41"
                stroke="currentColor" stroke-width="1.2" fill="none" />
            </svg>
            <span>照明</span>
          </div>
          <div class="lighting-controls">
            <div class="light-row light-row-select">
              <span class="light-label">種別</span>
              <select id="light-mode-select" class="light-select">
                <option value="light" selected>光</option>
                <option value="shadow">影</option>
              </select>
              <span class="light-value">-</span>
            </div>
            <div class="light-row light-row--light">
              <span class="light-label">方位角</span>
              <input type="range" id="light-azimuth" class="light-slider" min="-180" max="180" value="20" step="1">
              <span id="light-azimuth-val" class="light-value">20°</span>
            </div>
            <div class="light-row light-row--light">
              <span class="light-label">仰角</span>
              <input type="range" id="light-elevation" class="light-slider" min="-85" max="-5" value="-50" step="1">
              <span id="light-elevation-val" class="light-value">-50°</span>
            </div>
            <div class="light-row light-row--light">
              <span class="light-label">光の強さ</span>
              <input type="range" id="light-intensity" class="light-slider" min="0" max="200" value="100" step="1">
              <span id="light-intensity-val" class="light-value">1.0</span>
            </div>
            <div class="light-row light-row--light">
              <span class="light-label">環境光</span>
              <input type="range" id="light-ambient" class="light-slider" min="0" max="200" value="0" step="1">
              <span id="light-ambient-val" class="light-value">0.0</span>
            </div>
            <div class="light-row light-row--shadow">
              <span class="light-label">影の濃さ</span>
              <input type="range" id="light-shadow" class="light-slider" min="0" max="100" value="45" step="1">
              <span id="light-shadow-val" class="light-value">0.45</span>
            </div>
            <div class="light-row light-row--shadow">
              <span class="light-label">セルフ影境界</span>
              <input type="range" id="light-self-shadow-softness" class="light-slider" min="5" max="120" value="35" step="1">
              <span id="light-self-shadow-softness-val" class="light-value">0.035</span>
            </div>
            <div class="light-row light-row--shadow">
              <span class="light-label">遮蔽影境界</span>
              <input type="range" id="light-occlusion-shadow-softness" class="light-slider" min="5" max="120" value="35" step="1">
              <span id="light-occlusion-shadow-softness-val" class="light-value">0.035</span>
            </div>
          </div>
        </section>

        <!-- 6: Accessory Controls -->
        <section id="accessory-section" class="bottom-section">
          <div class="section-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
              <rect x="2.2" y="4.2" width="9.6" height="6.6" rx="1.4" fill="none" stroke="currentColor" stroke-width="1.2" />
              <path d="M4.4 7.5h5.2M4.4 9.2h3.2" stroke="currentColor" stroke-width="1.1" />
            </svg>
            <span>アクセサリー</span>
          </div>
          <div id="accessory-controls" class="accessory-controls">
            <div class="panel-select-row">
              <span class="panel-select-label">対象</span>
              <select id="accessory-select" class="panel-select" disabled>
                <option value="">-</option>
              </select>
            </div>
            <div class="info-actions accessory-actions">
              <button id="btn-accessory-visibility" class="info-action-btn" type="button" disabled>非表示</button>
              <button id="btn-accessory-delete" class="info-action-btn info-action-btn--danger" type="button" disabled>削除</button>
            </div>
            <div class="panel-select-row">
              <span class="panel-select-label">親</span>
              <select id="accessory-parent-model" class="panel-select" disabled>
                <option value="">World</option>
              </select>
            </div>
            <div class="panel-select-row">
              <span class="panel-select-label">ボーン</span>
              <select id="accessory-parent-bone" class="panel-select" disabled>
                <option value="">-</option>
              </select>
            </div>
            <div class="accessory-transform">
              <div class="accessory-row">
                <span class="accessory-label">X</span>
                <input type="range" id="accessory-pos-x" class="accessory-slider" min="-100" max="100" value="0" step="0.1">
                <span id="accessory-pos-x-val" class="accessory-value">0.00</span>
              </div>
              <div class="accessory-row">
                <span class="accessory-label">Y</span>
                <input type="range" id="accessory-pos-y" class="accessory-slider" min="-100" max="100" value="0" step="0.1">
                <span id="accessory-pos-y-val" class="accessory-value">0.00</span>
              </div>
              <div class="accessory-row">
                <span class="accessory-label">Z</span>
                <input type="range" id="accessory-pos-z" class="accessory-slider" min="-100" max="100" value="0" step="0.1">
                <span id="accessory-pos-z-val" class="accessory-value">0.00</span>
              </div>
              <div class="accessory-row">
                <span class="accessory-label">Rx</span>
                <input type="range" id="accessory-rot-x" class="accessory-slider" min="-180" max="180" value="0" step="0.1">
                <span id="accessory-rot-x-val" class="accessory-value">0.0°</span>
              </div>
              <div class="accessory-row">
                <span class="accessory-label">Ry</span>
                <input type="range" id="accessory-rot-y" class="accessory-slider" min="-180" max="180" value="0" step="0.1">
                <span id="accessory-rot-y-val" class="accessory-value">0.0°</span>
              </div>
              <div class="accessory-row">
                <span class="accessory-label">Rz</span>
                <input type="range" id="accessory-rot-z" class="accessory-slider" min="-180" max="180" value="0" step="0.1">
                <span id="accessory-rot-z-val" class="accessory-value">0.0°</span>
              </div>
              <div class="accessory-row">
                <span class="accessory-label">Si</span>
                <input type="range" id="accessory-scale" class="accessory-slider" min="1" max="500" value="100" step="1">
                <span id="accessory-scale-val" class="accessory-value">100%</span>
              </div>
            </div>
            <div class="accessory-empty-state" id="accessory-empty-state">
              <span>アクセサリー未読込</span>
              <span class="accessory-empty-sub">.x を読み込むとここで操作できます</span>
            </div>
          </div>
        </section>

        <!-- 7: Output Controls -->
        <section id="output-section" class="bottom-section">
          <div class="section-header">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
              <rect x="2" y="2" width="10" height="10" rx="1.5" fill="none" stroke="currentColor" stroke-width="1.2" />
              <path d="M5 7h4M7 5v4" stroke="currentColor" stroke-width="1.2" />
            </svg>
            <span>出力</span>
          </div>
          <div class="output-controls">
            <div class="output-row">
              <span class="output-label">比率</span>
              <select id="output-aspect" class="output-select">
                <option value="16:9">16:9 横</option>
                <option value="9:16">9:16 縦</option>
                <option value="1:1">1:1 正方形</option>
                <option value="4:3">4:3 横</option>
                <option value="3:4">3:4 縦</option>
                <option value="viewport">現在の画面比</option>
              </select>
            </div>
            <div class="output-row">
              <span class="output-label">長辺</span>
              <select id="output-size-preset" class="output-select">
                <option value="1280">HD</option>
                <option value="1920" selected>FullHD</option>
                <option value="2560">QHD</option>
                <option value="3840">4K</option>
              </select>
            </div>
            <div class="output-row output-row-dimensions">
              <span class="output-label">サイズ</span>
              <div class="output-dimensions">
                <input id="output-width" class="output-number" type="number" min="320" max="8192" step="1" value="1920">
                <span class="output-dim-sep">x</span>
                <input id="output-height" class="output-number" type="number" min="180" max="8192" step="1" value="1080">
              </div>
            </div>
            <div class="output-row output-row-toggle">
              <span class="output-label">固定</span>
              <label class="output-toggle-label">
                <input id="output-lock-aspect" type="checkbox" checked>
                <span>比率を維持</span>
              </label>
            </div>
            <div class="output-row">
              <span class="output-label">画質</span>
              <select id="output-quality" class="output-select">
                <option value="1" selected>標準 x1.0</option>
                <option value="1.5">高画質 x1.5</option>
                <option value="2">超高画質 x2.0</option>
              </select>
            </div>
            <button id="btn-export-png" class="playback-export-btn" title="現在の描画をPNGで保存">
              <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                <path d="M4 2h8a1 1 0 0 1 1 1v2h-2V4H5v7h2v2H4a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1z" />
                <path d="M8 8h2V5l3 3-3 3V8H8z" />
              </svg>
              <span>PNG保存</span>
            </button>
            <button id="btn-export-png-seq" class="playback-export-btn" title="連番PNGを書き出し">
              <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                <path d="M4 2h8a1 1 0 0 1 1 1v2h-2V4H5v7h2v2H4a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1z" />
                <path d="M8 8h2V5l3 3-3 3V8H8z" />
              </svg>
              <span>PNG Seq</span>
            </button>
          </div>
        </section>

      </div>
    </footer>

    <div id="ui-busy-overlay" class="ui-busy-overlay hidden" aria-hidden="true">
      <div class="ui-busy-card">
        <div class="loading-spinner"></div>
        <div id="ui-busy-text" class="ui-busy-text">Exporting PNG sequence...</div>
      </div>
    </div>
  </div>

  <script type="module" src="/src/renderer.ts"></script>
</body>

</html>

